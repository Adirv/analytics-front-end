<div data-aid="report-overview" class="kReport kContent kOverrideFAIcons">
  <div class="kReportView">
    <div class="kFilters">
      <span class="kTitle">Usage in 12 months preceding August 2021</span>
    </div>

    <app-overview-metrics-selector-dropdown [options]="_mainMetricsOptions"
                                   [colorsMap]="_colorsMap"
                                   (change)="_onChange()"
                                   [(selection)]="_selectedMain"></app-overview-metrics-selector-dropdown>

    <k-area-blocker [message]="blockerMessage" [showLoader]="isBusy">

      <div class="kReportContent">
        <div class="kChart">
          <div echarts class="kChart"
               *ngIf="barChartData && barChartData[selectedMetrics] && barChartData[selectedMetrics].series && barChartData[selectedMetrics].series[0]?.data?.length"
               [options]="barChartData[selectedMetrics]"></div>
          <div
            *ngIf="!isBusy && (!barChartData || !barChartData[selectedMetrics] || !barChartData[selectedMetrics]?.series[0]?.data?.length)"
            class="kNoResults">
            <span>{{'app.common.noResults' | translate}}</span>
          </div>
        </div>

        <div class="kTable">
          <div class="kToggle">
            <i [class.kIcondropdown_arrow_bottom]="!_showTable" [class.kIcondropdown_arrow_top]="_showTable"></i>
            <a (click)="toggleTable()">{{(_showTable ? 'app.common.hideDetails' : 'app.common.viewDetails') | translate}}</a>
          </div>
          <div class="kTableContainer" [class.kOpen]="_showTable" [class.kClose]="!_showTable">
            <p-table appScrollTopOnPaging
                     [value]="_tableData"
                     [paginator]="true"
                     [rows]="_pageSize"
                     [customSort]="true"
                     [sortField]="_columns[0]"
                     [sortOrder]="-1"
                     [defaultSortOrder]="-1"
                     (sortFunction)="_onSortChanged($event)">
              <ng-template pTemplate="header">
                <tr>
                  <th *ngFor="let col of _columns" [pSortableColumn]="col">
                    <div class="kColumnHeader">
                    <span [kTooltip]="'app.bandwidth.publisher_table.' + col | translate" [showOnEllipsis]="true">
                      {{'app.bandwidth.publisher_table.' + col | translate}}
                    </span>
                      <p-sortIcon [field]="col"></p-sortIcon>
                    </div>
                  </th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-data>
                <tr>
                  <td *ngFor="let col of _columns; let i = index" [class.kHighlight]="i===0">
                    <span *ngIf="data[col]?.value === undefined">{{data[col]}}</span>
                  </td>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage">
                <div class="emptymessage">
                  <div class="kEmptyMessage" *ngIf="!isBusy">{{'app.common.noResults' | translate}}</div>
                  <div class="kEmptyMessage" *ngIf="isBusy">&nbsp;</div>
                </div>
              </ng-template>
            </p-table>
          </div>
        </div>

      </div>

    </k-area-blocker>

  </div>
</div>

